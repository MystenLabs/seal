<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Design" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Seal Design | Seal Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://seal-docs.wal.app/Design"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Seal Design | Seal Documentation"><meta data-rh="true" name="description" content="Learn how Seal uses Identity-Based Encryption (IBE) to provide secure, policy-driven data encryption with decentralized key management on Sui."><meta data-rh="true" property="og:description" content="Learn how Seal uses Identity-Based Encryption (IBE) to provide secure, policy-driven data encryption with decentralized key management on Sui."><meta data-rh="true" name="keywords" content="Seal design,identity-based encryption,IBE,key servers,access policies,time-lock encryption,MPC committee,threshold encryption,decentralization"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://seal-docs.wal.app/Design"><link data-rh="true" rel="alternate" href="https://seal-docs.wal.app/Design" hreflang="en"><link data-rh="true" rel="alternate" href="https://seal-docs.wal.app/Design" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Seal Design","item":"https://seal-docs.wal.app/Design"}]}</script><script>window.__COPY_PAGE_BUTTON_OPTIONS__={customStyles:{},enabledActions:["copy","view","chatgpt","claude"],id:"default"}</script>
<link key="docusaurus-plugin-plausible-preconnect" rel="preconnect" href="https://plausible.io">
<script key="docusaurus-plugin-plausible-script" async defer="defer" data-domain="https://seal-docs.wal.app" src="https://plausible.io/js/plausible.js"></script>
<script key="docusaurus-plugin-plausible-custom-events">window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script>
<meta name="algolia-site-verification" content="BCA21DA2879818D2"><link rel="stylesheet" href="/assets/css/styles.05dc90f7.css">
<script src="/assets/js/runtime~main.4de82159.js" defer="defer"></script>
<script src="/assets/js/main.a097ad57.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_LviR" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Seal Logo" class="themedComponent_Kol1 themedComponent--light_kufX"><img src="/img/logo.svg" alt="Seal Logo" class="themedComponent_Kol1 themedComponent--dark_hrfE"></div></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/MystenLabs/seal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_kAk_"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_Rl5H colorModeToggle_AwaA"><button class="clean-btn toggleButton_QYOY toggleButtonDisabled_JK9z" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_nbo7 lightToggleIcon_wavo"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_nbo7 darkToggleIcon_ZV6J"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_nbo7 systemToggleIcon_mxAQ"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer__cgi"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_D5Wb"><div class="docsWrapper_STMn"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_uE2c" type="button"></button><div class="docRoot_w8jp"><aside class="theme-doc-sidebar-container docSidebarContainer_sB7m"><div class="sidebarViewport_xaHd"><div class="sidebar_t5dI"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_xw2o"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/"><span title="What is Seal?" class="linkLabel_qxzL">What is Seal?</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/GettingStarted"><span title="Getting Started" class="linkLabel_qxzL">Getting Started</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ServerOverview"><span title="Seal Server Overview" class="linkLabel_qxzL">Seal Server Overview</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink__Ear menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/Design"><span title="Developer Guide" class="categoryLinkLabel_Q_Zz">Developer Guide</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Design"><span title="Seal Design" class="linkLabel_qxzL">Seal Design</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/UsingSeal"><span title="Using Seal" class="linkLabel_qxzL">Using Seal</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ExamplePatterns"><span title="Access Policy Example Patterns" class="linkLabel_qxzL">Access Policy Example Patterns</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SecurityBestPractices"><span title="Security Best Practices and Risk Mitigations" class="linkLabel_qxzL">Security Best Practices and Risk Mitigations</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink__Ear menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/KeyServerOps"><span title="Operator Guide" class="categoryLinkLabel_Q_Zz">Operator Guide</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Pricing"><span title="Seal Pricing" class="linkLabel_qxzL">Seal Pricing</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TermsOfService"><span title="Seal Terms of Service" class="linkLabel_qxzL">Seal Terms of Service</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_QMuH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_hrAY"><div class="docItemContainer_o2cG"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_TJli" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_neYB"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Developer Guide</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Seal Design</span></li></ul></nav><div class="tocCollapsible_YlOF theme-doc-toc-mobile tocMobile_qAHm"><button type="button" class="clean-btn tocCollapsibleButton_OlXN">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Seal Design</h1></header><blockquote>
<p>For a comprehensive technical analysis and formal security proofs, see the <a href="/assets/files/Seal_White_Paper_v1-c9370b2648a548b7b2e0b1c5d73ee49e.pdf" target="_blank" class="">Seal Whitepaper</a>.</p>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_V57r" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<p>Seal uses a cryptographic primitive called <em>Identity-Based Encryption (IBE)</em> to encrypt stored data. This design detail is abstracted away from both developers and users, as Seal does not have visibility into the data it helps secure.</p>
<p>An <a href="https://en.wikipedia.org/wiki/Identity-based_encryption" target="_blank" rel="noopener noreferrer" class="">IBE scheme</a> consists of the following algorithms:</p>
<ul>
<li class=""><code>Setup</code>: Generates a master secret key <code>msk</code> and a master public key <code>mpk</code>.</li>
<li class=""><code>Derive(msk, id)</code>: Given a master secret key and an identity <code>id</code> (string or byte array), generates a derived secret key <code>sk</code> for that identity.</li>
<li class=""><code>Encrypt(mpk, id, m)</code>: Given a public key, an identity, and a message, returns an encryption <code>c</code>.</li>
<li class=""><code>Decrypt(sk, c)</code>: Given a derived secret key and a ciphertext, compute the message <code>m</code>.</li>
</ul>
<p>Such a scheme is correct if for any <code>id</code> and <code>m</code>, <code>(msk, mpk) ← Setup()</code> and <code>c ← Encrypt(mpk, id, m)</code> we have <code>Decrypt(Derive(msk, id), c) = m</code>.</p>
<p>The domain of identities is not fixed and can be any string or byte array. Seal uses this property to bound on-chain strings to IBE identities.</p>
<p>Seal consists of two main components:</p>
<ul>
<li class=""><strong>Access policies defined on Sui:</strong> A Move package at address <code>PkgId</code> controls the subdomain of IBE identities that starts with <code>[PkgId]</code> (that is, all strings of the form <code>[PkgId]*</code>). You can think of <code>[PkgId]</code> as an identity <em>namespace</em>. The package defines, through Move code, who is authorized to access the keys associated with its identity subdomain.</li>
<li class=""><strong>off-chain key servers:</strong> Key servers are off-chain services, each holding a single IBE master secret key. Users can request a derived secret key for a specific identity. The key server returns the derived key only if the associated on-chain access policy approves the request.</li>
</ul>
<p>Consider the following basic example for realizing time-lock encryption:</p>
<div class="language-rust codeBlockContainer_vISq theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_AhnU"><pre tabindex="0" class="prism-code language-rust codeBlock_lwkX thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pwDh"><span class="token-line" style="color:#393A34"><span class="token plain">module </span><span class="token namespace" style="opacity:0.7">patterns</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token plain">tle</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">sui</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token plain">bcs</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">sui</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token plain">clock</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token class-name">ENoAccess</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">u64</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/////////////////////////////////////////////</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/// Access control</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/// The IBE identity being used: [pkg id][bcs::to_bytes(time)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/// The following function accepts only the inner identity, i.e., [bcs::to_bytes(time)], and Seal extends it with the namespace.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">entry fun </span><span class="token function" style="color:#d73a49">seal_approve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> vector</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">u8</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token namespace" style="opacity:0.7">clock</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token class-name">Clock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Convert the identity to u64.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">mut</span><span class="token plain"> prepared</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">BCS</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">bcs</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> t </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> prepared</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">peel_u64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> leftovers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> prepared</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">into_remainder_bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Check that the time has passed and the entire identity is consumed.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token macro property" style="color:#36acaa">assert!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">leftovers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">length</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">timestamp_ms</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">ENoAccess</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>The module controls all IBE identities that begin with its package ID <code>PkgId</code>. To encrypt data with a time-lock <code>T</code>, a user selects a key server and encrypts the data using the identity <code>[PkgId][bcs::to_bytes(T)]</code> and the server&#x27;s IBE master public key. Once the on-chain time on Sui exceeds <code>T</code>, anyone can request the decryption key for the identity <code>[PkgId][bcs::to_bytes(T)]</code> from the Seal key server. Access control is enforced by the <code>seal_approve</code> function defined in the module. This function receives the requested identity (excluding the <code>PkgId</code> prefix) and a <code>Clock</code> as arguments. It returns success only if the current time is greater than or equal to <code>T</code>. The key server evaluates <code>seal_approve</code> to determine whether the derived key can be returned.</p>
<p>Time-lock encryption can be applied to a variety of on-chain use cases, including MEV-resistant trading, secure voting, and more. For additional examples and useful implementation patterns, see <a class="" href="/ExamplePatterns">Example patterns</a>.</p>
<p>The framework is fully generic. Developers can define custom authorization logic within <code>seal_approve*</code> functions and choose which key servers to use based on their application&#x27;s needs. For example, they can use a fixed set of trusted key servers or allow users to select their preferred servers.</p>
<p>When you upgrade a package, it retains the same identity subdomain. To support secure upgrades, follow the recommended best practices for <a href="https://docs.sui.io/concepts/sui-move-concepts/packages/upgrade#versioned-shared-objects" target="_blank" rel="noopener noreferrer" class="">versioned shared objects</a>. Specifically, version your shared objects, or create a global versioned shared object for your package. For examples, see the <a class="" href="/ExamplePatterns">allowlist and subscription patterns</a>. Keep in mind that if a package is upgradeable, the access control policy can be changed at any time by the package owner. These changes are transparent and publicly visible on-chain.</p>
<h2 class="anchor anchorTargetStickyNavbar_V57r" id="decentralization-and-trust-model">Decentralization and trust model<a href="#decentralization-and-trust-model" class="hash-link" aria-label="Direct link to Decentralization and trust model" title="Direct link to Decentralization and trust model" translate="no">​</a></h2>
<p>Seal is designed to reduce centralization using a couple of mechanisms.</p>
<p>First, users can choose any combination of one or more key servers and use their master public keys to encrypt data. This setup supports <code>t-out-of-n</code> threshold encryption, which ensures:</p>
<ul>
<li class=""><strong>Privacy</strong> as long as fewer than <code>t</code> key servers are compromised.</li>
<li class=""><strong>Liveness</strong> as long as at least <code>t</code> key servers are available.</li>
</ul>
<p>Seal does not mandate the use of any specific key server. Instead, users can select key servers based on their own trust assumptions. Key servers can vary in security characteristics, such as running within secure enclaves or being air-gapped, and can operate across different locations and jurisdictions.</p>
<div class="theme-admonition theme-admonition-info admonition_qNOj alert alert--info"><div class="admonitionHeading_tudc"><span class="admonitionIcon_OTUU"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_lznt"><p>The set of key servers is not dynamic once the data is encrypted, and encrypted data cannot be changed to use a different set of servers.</p></div></div>
<p>Second, a single key server can also be implemented using a multi-party computation (MPC) committee in a <code>t-out-of-n</code> configuration. This committee can consist of Sui validators or any other group of participants. This mechanism is not yet available, but MPC-based key servers are expected to be deployed in the near future. Users can choose to use these in addition to standalone key servers. In this setup, the participants in the MPC committee can change over time, allowing for dynamic membership.</p>
<p>The security of encrypted data relies on the following assumptions:</p>
<ul>
<li class=""><strong>Key server integrity</strong>: The Seal key servers are not compromised, or, in the case of threshold encryption, fewer than the required threshold are compromised. This includes both the Seal key servers and the Sui full nodes they depend on to evaluate the access policies.</li>
<li class=""><strong>Correct access control policy</strong>: The access control policy associated with the encrypted data is accurate and appropriately configured. If package upgrades are enabled, the package owner can modify the policy at any time.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_V57r" id="key-server">Key server<a href="#key-server" class="hash-link" aria-label="Direct link to Key server" title="Direct link to Key server" translate="no">​</a></h2>
<p>A light server is initialized with an identity-based encryption (IBE) master secret key and has access to a trusted full node. In simple deployments, the server runs as a backend service with the secret key stored in protected storage, optionally secured using a software or hardware vault. More advanced deployments can use secure enclaves, MPC committees, or even air-gapped environments to enhance security.</p>
<p>The server exposes only two APIs:</p>
<ul>
<li class=""><code>/v1/service</code> - Returns information about the service&#x27;s on-chain registered information.</li>
<li class=""><code>/v1/fetch_key</code> - Handles a request for one or more derived keys and returns them if access is permitted by the associated package or policies. Each request must meet the following requirements:<!-- -->
<ul>
<li class="">Be signed by the user&#x27;s address using <code>signPersonalMessage</code>. For details, see the <a href="https://github.com/MystenLabs/seal/tree/main/crates/key-server/src/signed_message.rs" target="_blank" rel="noopener noreferrer" class="">signed_message</a> format.</li>
<li class="">Include a valid PTB, which is evaluated against the <code>seal_approve*</code> rules. For PTB construction guidelines, see <a href="https://github.com/MystenLabs/seal/tree/main/crates/key-server/src/valid_ptb.rs" target="_blank" rel="noopener noreferrer" class="">valid_ptb</a>.</li>
<li class="">Provide an ephemeral encryption key to encrypt the response. Encrypting the response ensures that only the requester (the initiator) can decrypt and access the returned keys.</li>
</ul>
</li>
</ul>
<p>See <a href="https://github.com/MystenLabs/seal/tree/main/crates/key-server/src/server.rs" target="_blank" rel="noopener noreferrer" class="">crates/key-server</a> for the implementation of the key server.</p>
<h2 class="anchor anchorTargetStickyNavbar_V57r" id="user-confirmation-and-sessions">User confirmation and sessions<a href="#user-confirmation-and-sessions" class="hash-link" aria-label="Direct link to User confirmation and sessions" title="Direct link to User confirmation and sessions" translate="no">​</a></h2>
<p>Decryption keys returned from the key server are returned directly to the caller, which is typically the dApp&#x27;s web page. To ensure that dApps can access only keys explicitly approved by the user, the user must approve the key access request in their wallet. This approval is granted once per package and authorizes a <code>session key</code>. The session key allows the dApp to retrieve associated decryption keys for a limited time without requiring repeated user confirmations.</p>
<h2 class="anchor anchorTargetStickyNavbar_V57r" id="cryptographic-primitives">Cryptographic primitives<a href="#cryptographic-primitives" class="hash-link" aria-label="Direct link to Cryptographic primitives" title="Direct link to Cryptographic primitives" translate="no">​</a></h2>
<p>Seal is designed to support multiple identity-based encryption (IBE) schemes as Key Encapsulation Mechanisms (KEMs) and various symmetric encryption schemes as Data Encapsulation Mechanisms (DEMs). Currently supported primitives include:</p>
<ul>
<li class=""><strong>KEM</strong>: Boneh-Franklin IBE with the BLS12-381 curve.</li>
<li class=""><strong>DEM</strong>: AES-256-GCM, HMAC based CTR mode.</li>
</ul>
<p>Prefer <code>AES-256-GCM</code> for most use cases as it is faster. Use <code>HMAC-CTR</code> only when you require on-chain decryption.</p>
<p>Post-quantum primitives are planned to be added in the future.</p>
<p>For advanced encryption schemes, use Seal as a KMS to protect the scheme&#x27;s secret key. This approach enables streaming, hardware-assisted, or chunked decryption while keeping keys out of application code.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/ServerOverview"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Seal Server Overview</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/UsingSeal"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Using Seal</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_tmgb thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#decentralization-and-trust-model" class="table-of-contents__link toc-highlight">Decentralization and trust model</a></li><li><a href="#key-server" class="table-of-contents__link toc-highlight">Key server</a></li><li><a href="#user-confirmation-and-sessions" class="table-of-contents__link toc-highlight">User confirmation and sessions</a></li><li><a href="#cryptographic-primitives" class="table-of-contents__link toc-highlight">Cryptographic primitives</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>